<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RDW - Katalog Produk Sound System Profesional</title>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAya-7QEtbflW7jh_EoPclFBQ43VnrKZrM",
  authDomain: "rdw-katalog.firebaseapp.com",
  databaseURL: "https://rdw-katalog-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "rdw-katalog",
  storageBucket: "rdw-katalog.firebasestorage.app",
  messagingSenderId: "506572005524",
  appId: "1:506572005524:web:43b7d27f2c33a1d4071481",
  measurementId: "G-BDQXKFERCR"
};

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Elemen dari DOM
    const productGrid = document.getElementById('product-grid');
    const modalOverlay = document.getElementById('modal-overlay');
    const modalImage = document.getElementById('modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalDesc = document.getElementById('modal-desc');
    const orderBtn = document.getElementById('order-btn');
    const modalCloseBtn = document.getElementById('modal-close-btn');
    const whatsappNumber = '6281229851775';

    // Ambil data produk dari Firebase
    function loadProducts() {
      const productsRef = ref(db, 'products');
      onValue(productsRef, snapshot => {
        const data = snapshot.val();
        productGrid.innerHTML = '';

        if (!data) {
          productGrid.innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#ff5252;font-weight:700;">Belum ada produk tersedia.</p>';
          return;
        }

        Object.values(data).forEach(product => {
          const card = document.createElement('article');
          card.className = 'card';
          card.tabIndex = 0;
          card.setAttribute('role', 'button');
          card.setAttribute('aria-pressed', 'false');
          card.setAttribute('aria-label', `Lihat detail ${product.name}`);
          card.innerHTML = `
            <img src="${product.image}" alt="${product.alt}" loading="lazy" />
            <h2>${product.name}</h2>
            <p>${product.description.split('\n')[0]}</p>
          `;
          card.addEventListener('click', () => openProductDetail(product));
          card.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              openProductDetail(product);
            }
          });
          productGrid.appendChild(card);
        });
      });
    }

    function openProductDetail(product) {
      modalImage.src = product.image;
      modalImage.alt = product.alt;
      modalTitle.textContent = product.name;
      modalDesc.textContent = product.description + '\n\nUntuk pemesanan, silakan klik tombol di bawah untuk menghubungi WhatsApp penjual.';
      const msg = encodeURIComponent(`Halo, saya ingin memesan produk *${product.name}* dari RDW. Mohon info lebih lanjut.`);
      orderBtn.onclick = () => {
        window.open(`https://wa.me/${whatsappNumber}?text=${msg}`, '_blank', 'noopener');
      };
      modalOverlay.classList.add('show');
      modalCloseBtn.focus();
    }

    function closeModal() {
      modalOverlay.classList.remove('show');
    }

    window.addEventListener('DOMContentLoaded', () => {
      loadProducts();
    });

    modalCloseBtn.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', (e) => {
      if (e.target === modalOverlay) closeModal();
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modalOverlay.classList.contains('show')) {
        closeModal();
      }
    });
  </script>

  <!-- Tetap gunakan CSS lama kamu di bawah -->
  <style>
    /* semua style kamu tetap digunakan tanpa perubahan */
    /* ... kamu tidak perlu ubah apapun di bagian CSS ... */
  </style>
</head>
<body>
<header>
  <div class="logo" tabindex="0" aria-label="Logo RDW Sound System Profesional">RDW</div>
</header>
<main class="container" id="main-content">
  <h1>Katalog Produk Sound System Profesional RDW</h1>
  <section aria-label="Daftar produk sound system" class="product-grid" id="product-grid"></section>
</main>
<footer>
  &copy; 2024 RDW Sound System Profesional - Semua hak cipta dilindungi.
</footer>

<!-- Modal Tetap Sama -->
<div class="modal-overlay" id="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-desc">
  <div class="modal" tabindex="-1">
    <button class="close-btn" id="modal-close-btn" aria-label="Tutup deskripsi produk">&times;</button>
    <img src="" alt="" id="modal-image" />
    <h2 id="modal-title"></h2>
    <p class="description" id="modal-desc"></p>
    <button class="btn-order" id="order-btn">Pesan via WhatsApp</button>
  </div>
</div>
</body>
</html>

